<!DOCTYPE html>
<html lang="en" data-framework="typescript">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgreeTo Microsoft Authentication</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    const params = new Proxy(new URLSearchParams(window.location.search), {
      get: (searchParams, prop) => searchParams.get(prop),
    });
    const token = params.t;
    localStorage.setItem('ajwt', token)
    setTimeout(() => {
      window.close()
    }, 1000)
  </script>
</head>

<body>
  <div class="font-semibold text-xl text-center pt-16 h-screen">
    <div class="flex justify-center items-center my-16">
      <img class="w-20 h-20" src="./assets/icon512.png" alt="AgreeTo" />
      <h1
        class="color-primary ml-2 text-4xl font-semibold"
        style="color: #2e81ff;"
      >
        AgreeTo
      </h1>
    </div>
    <p class="text-2xl text-green-600">You are successfully logged in!</p>
    <br />
    <p class="text-xl text-gray-600">You can open your addin now.</p>
  </div>
</body>
</html>